# 力场

- [力场](#力场)
  - [简介](#简介)
  - [力场的选择](#力场的选择)
  - [常见力场](#常见力场)
  - [参考](#参考)

Last updated: 2022-11-16, 15:40
****

## 简介

分子力学（Molecular Mechanics, MM）是一种计算方法，通过势能方程来分析分子体系。下面的势能方程基于键拉伸（bond stretching）、角弯曲（angle bending）、二面角（dihedral angles）、范德华力（Van der Waals）和库仑相互作用的能量项总和：

$$E_{MM}(R)=E_{str}+E_{bend}+E_{tors}+E_{cross}+E_{el}+E_{vdW}$$

该方程中包含的作用力可以分为成键项和非键项。$E_{MM}(R)$ 的每一项都可以用不同的函数表示。例如，其中的键能项 $E_{str}$ 可以表示为：

$$E_{str}=\sum_i \frac{k_i}{2}(l_i-l_{i,0})^2$$

该函数包含两个参数 $(k_i, l_{i,0})$ 和一个变量 $l_i$。用来表示分子力学势能函数中不同分量的函数形式，以及其包含的参数，就定义了所谓的**力场**（Force field, FF）。简而言之，一套函数及对应参数，就构成了一个力场。

每种贡献的参数可以通过实验或者量子力学计算得到，最终目标是开发出能够再现实验数据的参数。

开发一个分子中所有不同原子的参数是一项巨大的计算任务，在大多数情况下我们负担不起。因为相同官能团在不同环境下的行为基本相同，因此在特定 FF 下，可以通过转移参数（不同位置的相同官能团使用相同参数）大大降低参数量。

综上所述，力场主要由三部分组成：

- 原子类型列表
- 一组能量函数
- 能够拟合实验数据的参数集合

例如，对 $C=C$ 双键，在各种不同的分子中 $C=C$ 双键都有相似的平衡键长，因此可以在力场中可以定义原子类型 $C_{sp^2}$，用来描述所有系统中的 SP2 杂化的碳原子。这样，就不必计算每个 $C_{sp^2}$ 的参数。 

通过添加更多的原子类型和它们之间的相互作用，就慢慢建立起来力场。如添加 $C$, $H$, $Br$ 等感兴趣的原子以及它们之间的化学键 $C_{sp^3}-H$, $C_{sp^2}-Br$ 等。如果一个给定的官能团在某些构型中表现不同，例如，芳香环中的 $C=C$ 键，只需为这种特定情况创建一个新的原子类型。

## 力场的选择

没有正确的力场，力场也不唯一，力场的选择完全取决于它们的表现。

有些力场可能在某一类系统上特别准确，但是对其它类型的系统表现很差。需要选择适合自己问题的力场。计算化学总是需要在准确性和计算成本之间找到一个平衡。

在包含许多原子的大型系统中，为了减少计算量，我们需要选择包含更少参数的 $E_{MM}$ 的简化形式。比如，不适用检查项，使用简单谐振波近似建模 $E_{str}$ 和 $E_{ben}$，使用 LJ 函数近似 $E_{vdW}$。 

当系统足够小时，可以选择参数更多更复杂的力场，包含交叉项和更准确的函数形式。

目前，我们通常时候用特定于某一类分子的力场。例如，专门为蛋白质设计的力场，考虑了不同氨基酸的原子类型，并减少了参数量，从而可以处理大型系统。

## 常见力场

目前有许多力场可用，且在大多数时候都很有效，对刚接触计算化学的初学者非常有用。在选择力场要，要详细了解力场的优势和限制。

常见的分子力学力场：

- [AMBER](https://ambermd.org/AmberModels.php)：Assisted Model Building and Energy Refinement
- [CHARMM](https://academiccharmm.org/)：Chemistry at Harvard Macromolecular Mechanics 
- [GROMOS](http://www.gromos.net/)：GROningen MOlecular Simulation
- [OPLS](https://pubs.acs.org/doi/10.1021/ja9621760)：Optimized Potentials for Liquid Simulations

## 参考

- https://www.compchems.com/force-fields-in-molecular-dynamics/
