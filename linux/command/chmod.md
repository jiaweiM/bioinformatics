# chmod

- [chmod](#chmod)
  - [简介](#简介)
  - [数值方法](#数值方法)
  - [示例](#示例)

***

## 简介

在 Linux 中，每个文件所有一个所有者（owner）和一个组（group），并为三种不同类型的用户分配访问权限：

- 文件所有者（file owner）
- 组成员（group member）
- 其它（everybody else）

`File ownership` 可以使用 `chown` 和 `chgrp` 命令修改。

有三种文件权限类型：

- 读
- 写
- 执行

可以用 `ls` 命令查看文件权限：

```bash
$ ls -l filename.txt
-rw-r--r-- 12 linuxize users 12.0K Apr  8 20:51 filename.txt
|[-][-][-]-   [------] [---]
| |  |  | |      |       |
| |  |  | |      |       +-----------> 7. Group
| |  |  | |      +-------------------> 6. Owner
| |  |  | +--------------------------> 5. Alternate Access Method
| |  |  +----------------------------> 4. Others Permissions
| |  +-------------------------------> 3. Group Permissions
| +----------------------------------> 2. Owner Permissions
+------------------------------------> 1. File Type
```

内容为：

1. 文件类型：常规文件 `-`，目录 `d`，符号链接 `l` 或其它类型文件

接下来 9 个字符表示文件权限，每 3 个字符对应一种用户类型：

2. Owner 权限，`rw-` 表示读写权限
3. Group 权限，`r--` 表示只读
4. 其它用户权限

三元字符的每一个都可以由以下字符构成，根据是文件还是目录效果不同。

**文件权限**

| 权限 | 字符 | 含义 |
|--|--|--|
| Read | `-` | 不可读 |
|  | `r` | 可读 |
| Write | `-` | 文件不可修改 |
|  | `w` | 文件可以修改 |
| Execute | `-` | 文件不可执行 |
|  | `x` | 文件可以执行 |
|  | `s` | 在 `user` 三元组中表示设置 `setuid` bit；在 `group` 三元组中表示设置 `setgid` bit。同时表示设置 `x`。在可执行文件上设置 `setuid` 或 `setgid`，则该文件以 owner 或 group 权利执行 |
|  | `S` | 同 `s` 但不设置 `x`。该 flag 在文件上极少使用 |
|  | `t` | 在 `others` 三元组中设置 `sticky` bit。同时设置 `x` flag。在文件上无用 |
|  | `T` | 同 `t` 但不设置 `x`。在文件上无用 |

**目录权限**



`chmod` (change mode) 用于改变文件或目录权限。默认只有文件的所有者和管理员可以设置文件权限，普通用户只能管理自己文件的权限属性。



设置权限时可以使用数字法，亦可使用字母表达式，对于目录文件建议加入 `-R` 参数进行递归操作，意味着不仅对于目录本身，也对目录内的子文件/目录都进行新权限的设定。

```sh
chmod 参数 文件
```

|选项|说明|
|---|---|
|-c|若该文件权限确实已经更改，才显示其更改动作|
|-f|若该文件权限无法被更改也不显示错误讯息|
|-v|显示权限变更的详细资料|
|-R|对目前目录下的所有文件与子目录进行相同的权限变更(即以递回的方式逐个变更)|

## 数值方法

使用数值设置权限，格式：

```bash
chmod [OPTIONS] NUMBER FILE...
```

使用数字模式时，可以同时设置三类用户的权限。

其中 `NUMBER` 可以是 3 位或 4 为数字。

对三位数字：第一位是 owner 权限，第二位是 group 权限，最后是 other 权限。

读、写和执行权限以如下数值表示：

- `r` = 4
- `w` = 2
- `x` = 1
- no permissions = 0

特定用户的权限编号由权限值的加和表示。

例如，对 owner 读写和执行权限，给 group 读和执行权限，给 other 只读权限：

- Owner: rwx=4+2+1=7
- Group: r-x=4+0+1=5
- Other: r--=4+0+0=4

对应 `NUMBER` 值为 `754`。



## 示例

